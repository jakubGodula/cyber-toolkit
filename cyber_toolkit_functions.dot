digraph cyber_toolkit {
  // Graph styling
  graph [fontname="Arial", fontsize=14, rankdir=TB, splines=true, overlap=false, nodesep=0.8, ranksep=1.0];
  node [fontname="Arial", fontsize=12, shape=box, style="rounded,filled", fillcolor="#f0f8ff", color="#4682b4", penwidth=1.5];
  edge [fontname="Arial", fontsize=10, color="#4682b4", penwidth=1.0];

  // Main cluster for the application
  subgraph cluster_main {
    label="cyber-toolkit main";
    style=filled;
    color="#e6f3ff";
    fillcolor="#e6f3ff";
    
    // Main entry point
    main [label="main\nCLI entry point", fillcolor="#ffe6cc"];
  }

  // Command handler cluster
  subgraph cluster_command_handlers {
    label="Command Handlers";
    style=filled;
    color="#e6f3ff";
    fillcolor="#e6f3ff";
    
    handle_add_command [label="handle_add_command\nAdd roles and install tools"];
    handle_update_command [label="handle_update_command\nUpdate system to target roles"];
    handle_remove_command [label="handle_remove_command\nRemove roles and unique tools"];
    handle_current_command [label="handle_current_command\nDisplay current roles"];
  }

  // Role management cluster
  subgraph cluster_role_management {
    label="Role Management";
    style=filled;
    color="#e6f3ff";
    fillcolor="#e6f3ff";
    
    display_available_roles [label="display_available_roles\nShow available roles"];
    display_available_roles_and_tools [label="display_available_roles_and_tools\nShow roles with their tools"];
    read_roles_from_config_file [label="read_roles_from_config_file\nRead ~/.roles/roles.cnf"];
    write_roles_to_config_file [label="write_roles_to_config_file\nWrite to ~/.roles/roles.cnf"];
  }

  // Tool management cluster
  subgraph cluster_tool_management {
    label="Tool Management";
    style=filled;
    color="#e6f3ff";
    fillcolor="#e6f3ff";
    
    fetch_tools_for_role_files [label="fetch_tools_for_role_files\nFetch tools from GitHub repo"];
    run_pacman_command [label="run_pacman_command\nRun pacman operations"];
  }

  // Utility functions cluster
  subgraph cluster_utilities {
    label="Utilities";
    style=filled;
    color="#e6f3ff";
    fillcolor="#e6f3ff";
    
    check_if_user_is_root [label="check_if_user_is_root\nCheck for root privileges"];
    elevate_to_root [label="elevate_to_root\nRe-run with sudo"];
  }

  // Main function relationships
  main -> display_available_roles;
  main -> display_available_roles_and_tools;
  main -> read_roles_from_config_file;
  main -> handle_add_command;
  main -> handle_update_command;
  main -> handle_remove_command;
  main -> handle_current_command;

  // Command handler relationships
  handle_update_command -> handle_add_command;
  handle_update_command -> handle_remove_command;
  handle_update_command -> read_roles_from_config_file;
  
  handle_add_command -> read_roles_from_config_file;
  handle_add_command -> write_roles_to_config_file;
  handle_add_command -> fetch_tools_for_role_files;
  handle_add_command -> run_pacman_command;
  
  handle_remove_command -> read_roles_from_config_file;
  handle_remove_command -> write_roles_to_config_file;
  handle_remove_command -> fetch_tools_for_role_files;
  handle_remove_command -> run_pacman_command;
  
  handle_current_command -> read_roles_from_config_file;

  // Role management relationships
  display_available_roles_and_tools -> fetch_tools_for_role_files;
  
  // Tool management relationships
  // (These are covered by the command handlers)
}

